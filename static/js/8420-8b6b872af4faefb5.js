(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8420],{68406:function(e,t,r){"use strict";r.d(t,{Z:function(){return N}});var n=r(90581),o=r(64297),a=r(58408),i=r(52322),s=r(2784),c=r(24949),l=r(45980),d=r(19261),u=r(59027),p=r(36586),h=r(83584),m=r(5632),f=r(83956),y=r(7283),g={UNKNOWN_ERROR:u.l.t("Unknown error occurred, please try refreshing the page."),XSOLLA_MODAL_ERROR:u.l.t("Something went wrong loading the Xsolla payment modal, please try refreshing the page."),NO_ITEMS:u.l.t("No items in cart."),INVALID_GIFT_UUID:u.l.t("Unable to find valid UUID for {uuid}. Did they recently change their username?"),BADLION_OUTAGE:u.l.t("We are currently experiencing an outage, please try again in a few minutes."),XSOLLA_OUTAGE:u.l.t("Our payment provider is currently down at the moment, please try again in a few minutes."),INVALID_STORE:u.l.t("Invalid store."),FREE_CART:u.l.t("You must have something with a price in your cart."),INVALID_CART:u.l.t("Invalid cart."),PRICE_CHANGED:u.l.t("Product pricing has changed, please refresh the page and try again. If you have a referral link active, please try reapplying the referral code."),BANNED_USER:u.l.t("You have been banned from the Badlion Store because of a chargeback dispute."),MULTIPLE_SUBSCRIPTIONS:u.l.t("You can only checkout with one subscription at a time."),DUPLICATE_SUBSCRIPTION:u.l.t("The recipient already has an active {subscription} subscription. They must cancel it on the account subscriptions page before you can continue with this."),PENDING_SUBSCRIPTION:u.l.t("This person already has a pending subscription purchase."),DUPLICATE_LIFETIME_RANK:u.l.t("You are not allowed to purchase more than one lifetime rank or a lifetime rank and an expiring rank purchase."),OVER_MAXIMUM:u.l.t("You are not allowed to purchase more than one of each cosmetic!"),NO_LONGER_AVAILABLE:u.l.t("One of the items is no longer available. Refreshing the page will remove invalid items from your cart."),BLC3_BUNDLE_ERROR:u.l.t("The recipient must have purchased a 3 month Insider subscription in order to buy them the remaining bundle cosmetics. Please wait for further confirmation from our payment provider or if you are returning to this portion at a later date, ensure your recipient is set correctly."),REFERRAL_MISSING:u.l.t("You must have {referral} referral activated to purchase their supporter pass."),INVALID_INSIDER_RECIPIENT:u.l.t("The user you are trying to purchase Insider for does not have a BLC account. They must set up a BLC account to receive the Insider gift.")},_=r(88288),v=r(3892),w=r(60223),S=r(71593),b=h.coreModule.getUuid,L=h.modalModule.showModal,I=h.modalModule.hideModal,E=h.mixpanelModule.mixpanelSendEvent,O=r(36808),x=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(){var e;return(0,n.Z)(this,r),e=t.apply(this,arguments),e.state={modalContent:void 0,paymentLoading:!1,stream:void 0,noClose:!0},e.onPurchaseButtonClick=function(t){t.preventDefault(),e.processPurchase();var r=e.props.router.query,n=r.source,o=r.utm_campaign,a=r.utm_medium,i=r.utm_source;e.props.mixpanelSendEvent("WEB_CHECKOUT_PURCHASE_BUTTON_CLICKED",JSON.stringify({path:e.props.router.pathname,domain:window.document.location.host.substring(0,window.document.location.host.indexOf(".")),source:n||"Direct",utm_campaign:o||"",utm_medium:a||"",utm_source:i||"",referral:O.get("referring")?JSON.parse(O.get("referring")).username:"",timestamp_web_event:Date.now()}))},e.processPurchase=function(){if(e.props.referralApply&&e.props.referralApply(),!(e.props.isFormInvalid&&e.props.isFormInvalid())){var t=e.props,r=t.uuid,n=t.recipient,o=t.total,a=t.getGroupFields,i=a&&a("billing")||e.props.billing,s=a&&a("purchase")||e.props.billing,c=e.props.cart.map(function(e){return{product_id:"".concat(e.product.id),qty:e.qty,price:e.price,extra_data:e.extra_data,for_uuid:e.for_uuid}}),l={global_coupon_id:e.props.couponID,referral_id:e.props.referralID,anonymous:!s.stream},u={billing:i,fill_ip:!0,for_uuid:n.uuid||r,items:c,total:o,uuid:r,extra_data:JSON.stringify(l),referrer_url:O.get("referrer-url",{domain:".badlion.net"})};e.setState({stream:d.BL.grpc.storejava.XSolla.xSollaCheckout.stream(u)},function(){var t,n;null===(t=e.state.stream)||void 0===t||t.onData(function(t){if(t.err&&e.handleFailure(t.err),"FREE_CART"===t.token){e.state.stream&&e.state.stream.write({uuid:r,fill_ip:!0,success:!0}),setTimeout(function(){e.props.shopEmptyCart()},5e3),(0,f.N)("trackSingle","Purchase"),e.props.router.push("checkout/complete/".concat(t.id));return}t.token&&e.showXsollaPaymentPage(t.token,t.id)}),null===(n=e.state.stream)||void 0===n||n.onError(function(t){e.handleFailure("UNKNOWN_ERROR")})})}},e.showXsollaPaymentPage=function(t,r){if(!window.XPayStationWidget){e.props.showModal("xsolla-modal"),e.setState({paymentLoading:!1,modalContent:u.l.t("Something went wrong loading the Xsolla payment modal, please try refreshing the page."),noClose:!1,stream:void 0});return}window.XPayStationWidget.init({access_token:t,sandbox:d.config.store.sandbox,childWindow:{target:"_parent"}}),window.XPayStationWidget.open(),window.XPayStationWidget.on(window.XPayStationWidget.eventTypes.STATUS,function(t,r){if("done"===r.paymentInfo.status){var n=e.props.uuid;e.state.stream&&e.state.stream.write({uuid:n,fill_ip:!0,success:!0}),e.props.shopEmptyCart();var o=e.props.router.query,a=o.source,i=o.utm_campaign,s=o.utm_medium,c=o.utm_source;e.props.mixpanelSendEvent("WEB_XSOLLA_CHECKOUT_PROCESS_COMPLETE",JSON.stringify({path:e.props.router.pathname,domain:window.document.location.host.substring(0,window.document.location.host.indexOf(".")),source:a||"Direct",utm_campaign:i||"",utm_medium:s||"",utm_source:c||"",referral:O.get("referring")?JSON.parse(O.get("referring")).username:"",timestamp_web_event:Date.now()})),(0,f.N)("trackSingle","Purchase")}}),window.XPayStationWidget.on(window.XPayStationWidget.eventTypes.CLOSE,function(){e.state.stream&&e.state.stream.end(),e.setState({paymentLoading:!1,modalContent:"",noClose:!1,stream:void 0})})},e.handleFailure=function(t){var r="";if("{"===t[0]){var n=JSON.parse(t);r=g[n.err],"DUPLICATE_SUBSCRIPTION"===n.err&&void 0!==n.subscription&&(r=r.replace("{subscription}",n.subscription)),"INVALID_GIFT_UUID"===n.err&&void 0!==n.uuid&&(r=r.replace("{uuid}",n.uuid)),"REFERRAL_MISSING"===n.err&&void 0!==n.referral&&(r=r.replace("{referral}",n.referral))}else r=t in g?g[t]:g.UNKNOWN_ERROR;e.props.showModal("xsolla-modal"),e.state.stream&&e.state.stream.end(),e.setState({paymentLoading:!1,modalContent:r,noClose:!1,stream:void 0})},e}return r.prototype.render=function(){var e=this;return(0,i.jsxs)(p.Block,{css:"margin-left: auto; width: 100%;",children:[(0,i.jsx)(S.zx,{disabled:this.props.disabled,className:"purchase-button",isActionButton:!0,css:"\n            width: 100%;\n            color: white;\n            padding: 10px 40px;\n            border-radius: 4px;\n            margin-top: 20px;\n            background-color: #2caddc;\n            font-size: 17px;\n            font-weight: 600;\n            color: #ffffff;\n          ",onClick:this.onPurchaseButtonClick,children:this.props.buttonText}),(0,i.jsxs)(p.DarkModal,{name:"xsolla-modal",maxWidth:p.v.breakpoints.xs,children:[(0,i.jsx)(p.DarkModalTitle,{children:u.l.t("Error")}),(0,i.jsx)(p.DarkModalContent,{p:"lg",children:this.state.modalContent})]}),(0,i.jsxs)(p.DarkModal,{name:"xsolla-modal-loading",noClose:!0,maxWidth:p.v.breakpoints.xs,children:[(0,i.jsx)(p.DarkModalTitle,{children:u.l.t("Processing")}),(0,i.jsxs)(p.DarkModalContent,{p:"lg",textAlign:"center",children:[u.l.t("Executing payment... please do not close this window or press the back button."),(0,i.jsx)(p.Block,{mt:"md",children:(0,i.jsx)(p.Loader,{lineProps:{backgroundColor:"yellow"}})})]})]}),(0,i.jsxs)(p.DarkModal,{name:"3.0-bundle-warning",maxWidth:p.v.breakpoints.xs,children:[(0,i.jsx)(p.DarkModalTitle,{children:u.l.t("Badlion Client 3.0 Bundle")}),(0,i.jsxs)(p.DarkModalContent,{p:"lg",children:[(0,i.jsx)(p.P,{children:u.l.t("To ensure your 3 Month Insider subscription is correctly charged and activated, this transaction will have two parts.")}),(0,i.jsx)(p.P,{children:u.l.t("The first transaction ($12 + applicable tax) for the Insider subscription, and the second transaction ($18 + applicable tax) for the cosmetics.")}),(0,i.jsx)(p.P,{children:u.l.t("We must split these transactions due to current technical limitations with our payment provider.")}),(0,i.jsx)(S.zx,{theme:"blueLight",display:"block",circle:!0,mx:"auto",p:"md",onClick:function(){e.props.hideModal("3.0-bundle-warning"),e.processPurchase()},children:u.l.t("Continue Purchase")})]})]})]})},r}(s.Component),C=(0,c.P1)(b,y.dv,y.I3,_.Sg,v.$q,w.K4,y.L2,function(e,t,r,n,o,a,i){return{uuid:e,cart:t,total:r,recipient:n,couponID:o,referralID:a,cartHasInsider:i}}),R={showModal:L,hideModal:I,shopEmptyCart:y.DM,mixpanelSendEvent:E},N=(0,m.withRouter)((0,l.connect)(C,R)(x))},42158:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var n=r(2784),o=r(20338),a=r.n(o),i=r(73463),s=r.n(i);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var l={},d=0;function u(e,t){return t=t||{},function(r){var o=r.displayName||r.name||"Component",i=function(o){function a(e,t){var r;return(r=o.call(this,e,t)||this).state={},r.__scriptURL="",r}i=a,s=o,i.prototype=Object.create(s.prototype),i.prototype.constructor=i,i.__proto__=s;var i,s,c=a.prototype;return c.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+d++),this.__scriptLoaderID},c.setupScriptURL=function(){return this.__scriptURL="function"==typeof e?e():e,this.__scriptURL},c.asyncScriptLoaderHandleLoad=function(e){var t=this;this.setState(e,function(){return t.props.asyncScriptOnLoad&&t.props.asyncScriptOnLoad(t.state)})},c.asyncScriptLoaderTriggerOnScriptLoaded=function(){var e=l[this.__scriptURL];if(!e||!e.loaded)throw Error("Script is not loaded.");for(var r in e.observers)e.observers[r](e);delete window[t.callbackName]},c.componentDidMount=function(){var e=this,r=this.setupScriptURL(),n=this.asyncScriptLoaderGetScriptLoaderID(),o=t,a=o.globalName,i=o.callbackName,s=o.scriptId;if(a&&void 0!==window[a]&&(l[r]={loaded:!0,observers:{}}),l[r]){var c=l[r];if(c&&(c.loaded||c.errored)){this.asyncScriptLoaderHandleLoad(c);return}c.observers[n]=function(t){return e.asyncScriptLoaderHandleLoad(t)};return}var d={};d[n]=function(t){return e.asyncScriptLoaderHandleLoad(t)},l[r]={loaded:!1,observers:d};var u=document.createElement("script");for(var p in u.src=r,u.async=!0,t.attributes)u.setAttribute(p,t.attributes[p]);s&&(u.id=s);var h=function(e){if(l[r]){var t=l[r].observers;for(var n in t)e(t[n])&&delete t[n]}};i&&"undefined"!=typeof window&&(window[i]=function(){return e.asyncScriptLoaderTriggerOnScriptLoaded()}),u.onload=function(){var e=l[r];e&&(e.loaded=!0,h(function(t){return!i&&(t(e),!0)}))},u.onerror=function(){var e=l[r];e&&(e.errored=!0,h(function(t){return t(e),!0}))},document.body.appendChild(u)},c.componentWillUnmount=function(){var e=this.__scriptURL;if(!0===t.removeOnUnmount)for(var r=document.getElementsByTagName("script"),n=0;n<r.length;n+=1)r[n].src.indexOf(e)>-1&&r[n].parentNode&&r[n].parentNode.removeChild(r[n]);var o=l[e];o&&(delete o.observers[this.asyncScriptLoaderGetScriptLoaderID()],!0===t.removeOnUnmount&&delete l[e])},c.render=function(){var e=t.globalName,o=this.props,a=(o.asyncScriptOnLoad,o.forwardedRef),i=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t.indexOf(r=a[n])>=0||(o[r]=e[r]);return o}(o,["asyncScriptOnLoad","forwardedRef"]);return e&&"undefined"!=typeof window&&(i[e]=void 0!==window[e]?window[e]:void 0),i.ref=a,(0,n.createElement)(r,i)},a}(n.Component),u=(0,n.forwardRef)(function(e,t){return(0,n.createElement)(i,c({},e,{forwardedRef:t}))});return u.displayName="AsyncScriptLoader("+o+")",u.propTypes={asyncScriptOnLoad:a().func},s()(u,r)}}},33266:function(e,t,r){"use strict";var n=r(7518);function o(){}function a(){}a.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,a,i){if(i!==n){var s=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:o};return r.PropTypes=r,r}},20338:function(e,t,r){e.exports=r(33266)()},7518:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}}]);